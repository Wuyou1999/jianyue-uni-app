(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-userinfo-userinfo"],{"0668":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(a("cb96")),i=o(a("6886"));function o(t){return t&&t.__esModule?t:{default:t}}var s={components:{uniList:n.default,uniListItem:i.default},data:function(){return{nickname:uni.getStorageSync("login_key").nickname,avatar:uni.getStorageSync("login_key").avatar,userId:uni.getStorageSync("login_key").userId}},onLoad:function(){uni.setNavigationBarTitle({title:"个人资料修改"})},methods:{showActionSheet:function(){var t=this;uni.showActionSheet({itemList:["拍照","从相册选择"],success:function(e){console.log("选中了第"+(e.tapIndex+1)+"个按钮"),0==e.tapIndex&&uni.chooseImage({count:1,sourceType:["camera"],success:function(e){uni.saveImageToPhotosAlbum({filePath:e.tempFilePaths[0],success:function(){console.log("save success"),uni.uploadFile({url:"http://112.74.177.53:8080/api/user/avatar",filePath:e.tempFilePaths[0],name:"file",formData:{userId:t.userId},success:function(e){console.log(e.data),t.avatar=e.data},complete:function(){console.log("save"),uni.request({url:"http://112.74.177.53:8080/api/user/"+uni.getStorageSync("login_key").userId,method:"GET",data:{userId:t.userId},header:{"content-type":"application/json"},success:function(t){console.log("save2"),0==t.data.code&&uni.setStorageSync("login_key",{userId:t.data.data.id,nickname:t.data.data.nickname,avatar:t.data.data.avatar,token:t.data.data.token,credit:t.data.data.credit,login:!0})}})}})}})}}),1==e.tapIndex&&uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(e){console.log(JSON.stringify(e.tempFilePaths)),uni.uploadFile({url:"http://112.74.177.53:8080/api//user/avatar",filePath:e.tempFilePaths[0],name:"file",formData:{userId:t.userId},success:function(e){console.log(e.data),t.avatar=e.data},complete:function(){console.log("save"),uni.request({url:"http://112.74.177.53:8080/api/user/"+uni.getStorageSync("login_key").userId,method:"GET",data:{userId:t.userId},header:{"content-type":"application/json"},success:function(t){console.log("save2"),0==t.data.code&&uni.setStorageSync("login_key",{userId:t.data.data.id,nickname:t.data.data.nickname,avatar:t.data.data.avatar,token:t.data.data.token,credit:t.data.data.credit,login:!0})}})}})}})},fail:function(t){console.log(t.errMsg)}})},updateUser:function(t){var e=this,a=this;uni.request({url:this.apiServer+"/user/nickname?id="+uni.getStorageSync("login_key").userId,method:"put",data:t,header:{"content-type":"application/json"},success:function(t){console.log("save"),uni.request({url:e.apiServer+"/user/"+uni.getStorageSync("login_key").userId,method:"GET",data:{userId:a.userId},header:{"content-type":"application/json"},success:function(t){console.log("save2"),0==t.data.code&&uni.setStorageSync("login_key",{userId:t.data.data.id,nickname:t.data.data.nickname,avatar:t.data.data.avatar,token:t.data.data.token,credit:t.data.data.credit,login:!0})}}),uni.showToast({title:"修改成功！",duration:2500})}})}}};e.default=s},a07b:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".message-1[data-v-bcba6e5a]{font-size:18px;color:#de533a}.container[data-v-bcba6e5a]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:18px}.nickname-box[data-v-bcba6e5a]{width:100%;height:90px;background-color:#fff;border-bottom:1px solid #e3e3e6;margin-bottom:13px;padding-left:14px}.avatar-box[data-v-bcba6e5a]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;height:70px;background-color:#fff;border-bottom:1px solid #e3e3e6;padding-left:14px}.password-box[data-v-bcba6e5a]{width:100%;\n\t/* height: 123px; */background-color:#fff;margin-bottom:10px}.kong[data-v-bcba6e5a]{width:40px}.update[data-v-bcba6e5a]{width:50%;height:58px;border-radius:10px;background-color:#ea6f5a;color:#fff;border:none;outline:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}",""])},c00b:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"container"},[a("v-uni-view",[a("v-uni-text",{staticClass:"message-1"},[t._v("常规设置")])],1),a("v-uni-view",{staticClass:"nickname-box"},[a("v-uni-text",{staticClass:"nickname"},[t._v("当前昵称:"+t._s(t.nickname))]),a("br"),a("v-uni-text",{staticClass:"nickname"},[t._v("更改昵称:")]),a("v-uni-input",{staticClass:"nickname-input",attrs:{type:"text",placeholder:"输入新的昵称",required:"required"},model:{value:t.renickname,callback:function(e){t.renickname=e},expression:"renickname"}})],1),a("v-uni-view",{staticClass:"avatar-box"},[a("v-uni-text",{},[t._v("更换头像")]),a("v-uni-view",{staticClass:"kong"}),a("v-uni-image",{staticClass:"avatar",attrs:{src:t.avatar},on:{click:function(e){e=t.$handleEvent(e),t.showActionSheet(e)}}})],1),a("v-uni-view",[a("uni-list-item",{attrs:{title:"更改性别",note:"男"}}),a("uni-list-item",{attrs:{title:"更改生日",note:"1999-02-15"}}),a("uni-list-item",{attrs:{title:"更改主页"}}),a("uni-list-item",{attrs:{title:"更改个人简介",note:"我本将心向明月,奈何明月照沟渠"}})],1),a("v-uni-view",{staticClass:"password-box"},[a("v-uni-view",[a("v-uni-text",{staticClass:"message-1"},[t._v("安全设置")])],1),a("v-uni-navigator",{attrs:{url:"../userinfo/newpsd"}},[a("uni-list-item",{attrs:{title:"重置密码"}})],1),a("uni-list-item",{attrs:{title:"绑定微信",thumb:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=3336519328,2903738409&fm=26&gp=0.jpg"}}),a("uni-list-item",{attrs:{title:"绑定微博",thumb:"http://wuyou-soft.oss-cn-hangzhou.aliyuncs.com/%E5%BE%AE%E5%8D%9A...png"}})],1),a("v-uni-button",{staticClass:"update",on:{click:function(e){e=t.$handleEvent(e),t.updateUser(t.renickname)}}},[t._v("确认修改")])],1)],1)},i=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})},c3f7:function(t,e,a){"use strict";var n=a("dda5"),i=a.n(n);i.a},da2b:function(t,e,a){"use strict";a.r(e);var n=a("0668"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);e["default"]=i.a},dda5:function(t,e,a){var n=a("a07b");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("e0f1b56e",n,!0,{sourceMap:!1,shadowMode:!1})},e26a:function(t,e,a){"use strict";a.r(e);var n=a("c00b"),i=a("da2b");for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);a("c3f7");var s=a("2877"),c=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"bcba6e5a",null);e["default"]=c.exports}}]);